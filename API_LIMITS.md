# Ограничения API по временным промежуткам

## Wildberries API

### Заказы (`/api/v1/supplier/orders`)
- **Параметр:** `dateFrom` (обязательный)
- **Параметр `dateTo`:** Не поддерживается - API возвращает все данные от `dateFrom` до текущего момента
- **Доступный период:** До 6 месяцев назад от текущей даты
- **Рекомендация:** Не запрашивать данные старше 6 месяцев
- **Текущая реализация:** Получаем данные только за сегодняшний день

### Продажи (`/api/v1/supplier/sales`)
- **Параметр:** `dateFrom` (обязательный)
- **Параметр `dateTo`:** Не поддерживается - API возвращает все данные от `dateFrom` до текущего момента
- **Доступный период:** До 6 месяцев назад от текущей даты
- **Рекомендация:** Не запрашивать данные старше 6 месяцев
- **Текущая реализация:** Получаем данные только за сегодняшний день

**Важно:** 
- API Wildberries не поддерживает параметр `dateTo`, поэтому при запросе данных за период нужно фильтровать результаты на стороне приложения
- При запросе данных за большой период (например, месяц) API может вернуть очень большой объем данных, что может привести к ошибке 429 или таймауту

---

## Ozon API

### Заказы FBS (`/v3/posting/fbs/list`)
- **Параметры:** `since` (начало периода) и `to` (конец периода)
- **Максимальный период в одном запросе:** До 30 дней
- **Доступный период:** До 3-6 месяцев назад (зависит от типа данных)
- **Рекомендация:** Для получения данных за больший период делать несколько запросов по 30 дней
- **Текущая реализация:** Получаем данные только за сегодняшний день

### Заказы FBO (`/v2/posting/fbo/list`)
- **Параметры:** `since` (начало периода) и `to` (конец периода)
- **Максимальный период в одном запросе:** До 30 дней
- **Доступный период:** До 3-6 месяцев назад (зависит от типа данных)
- **Рекомендация:** Для получения данных за больший период делать несколько запросов по 30 дней
- **Текущая реализация:** Получаем данные только за сегодняшний день

**Важно:**
- Ozon API поддерживает параметры `since` и `to`, что позволяет точно указать период
- При запросе данных за период больше 30 дней нужно разбивать запрос на несколько частей
- API может вернуть максимум 1000 записей в одном ответе (параметр `limit`), поэтому для больших периодов может потребоваться пагинация

---

## Рекомендации по использованию

### Для получения данных за период:

1. **Wildberries:**
   - Указать `dateFrom` на начало нужного периода
   - API вернет все данные от этой даты до текущего момента
   - Фильтровать результаты на стороне приложения по нужной дате

2. **Ozon:**
   - Указать `since` и `to` с разницей не более 30 дней
   - Для периодов больше 30 дней делать несколько запросов

### Оптимизация запросов:

- Не запрашивать данные за слишком большие периоды (риск ошибки 429)
- Использовать кэширование для часто запрашиваемых данных
- Делать запросы с задержками между ними (rate limiting)
- При получении ошибки 429 использовать retry с экспоненциальной задержкой

---

## Текущая реализация в проекте

В текущей версии приложения данные получаются только за **сегодняшний день** для обоих маркетплейсов. Это сделано для:
- Минимизации нагрузки на API
- Снижения риска получения ошибки 429
- Упрощения логики обработки данных

Для получения данных за другие периоды потребуется модификация методов в `app/services/marketplace_api.py`.

